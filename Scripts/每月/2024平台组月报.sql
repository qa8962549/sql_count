--购车页面浏览 分车型
select 
	car_type
	,count(distinct distinct_id) UV
	,count(distinct_id) PV
	,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
	,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
	,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
	,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where 1=1
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and event_time >='2024-05-01'
and event ='Page_entry'
and page_title='购车'
--and btn_name ='开始绑车'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by rollup(1)
order by 2 desc


select 
car_type
,btn_name DW
,distinct_id 
,page_title
,event 
,`time` 
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name ='立即订购'
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type in ('S60','V90 Cross Country')


-- 购车页面按钮点击（分车型）
select concat(x.car_type,x.DW) DW,
x.*
from 
(
-- EX30 button
select 
car_type
,btn_name DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name in ('预约试驾',
'立即订购',
'短促Banner',
'金融购车')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1,2
order by 1,2 desc
union all 
-- 服务承诺
select 
car_type
,'服务承诺' DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name ='了解详情'
and content_title='服务承诺'
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1
order by 1
union all 
-- 购车门店
select 
car_type
,'购车门店' DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and ((btn_name ='更多'and content_title='购车门店') or (btn_name in ('经销商图','导航icon')))
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1
order by 1
union all 
-- 常用工具
select 
car_type
,'常用工具' DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name in ('金融计算器','置换增购')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1
order by 1
union all 
-- 车型解读 
select 
car_type
,'车型解读' DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
--and btn_name ='内容'
and column_name in ('官方解读','大咖测评','用户口碑')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1
order by 1
union all 
-- 车型解读 '官方解读','大咖测评','用户口碑'
select 
car_type
,column_name DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
--and btn_name ='内容'
and column_name in ('官方解读','大咖测评','用户口碑')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1,2
order by 1,2
union all 
-- 总计（车主权益）  限时礼遇  会员权益  //里程从容 安心承诺 只己馈礼 专属管家 俱乐部权益 会员权益
select 
car_type
,btn_name DW
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and content_title='车主权益'
and btn_name<>'更多' -- 剔除，避免歧义
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1,2
order by 1,2
union all 
-- 总计（车主权益）
select 
car_type
,content_title DW
--,concat(car_type,content_title)
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and content_title='车主权益'
and btn_name<>'更多' -- 剔除，避免歧义
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1,2
order by 1,2
)x
order by 1



-- 总计（车主权益）
select 
car_type
--,content_title DW
,concat(car_type,content_title)
,count(distinct distinct_id) UV
,count(distinct_id) PV
,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
,count(case when var_is_bind in ('1','true') then distinct_id end) PV_bind	
,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
,count(distinct_id) - count(case when var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and content_title='车主权益'
and btn_name<>'更多' -- 剔除，避免歧义
and event_time >='2024-10-01'
and event_time <'2024-11-01'
and `date` >= '2024-10-01' 
and `date` <'2024-11-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type is not null 
group by 1,2
order by 1,2

-- 按钮测试 test
select *
--car_type
--,content_title
--,btn_name
--,column_name
--,column_name DW
--,count(distinct distinct_id) UV
--,count(distinct_id) PV
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and content_title='车主权益'
and btn_name='更多' -- 剔除，避免歧义
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
--and car_type is not null 
and car_type in ('EM90','EX30')
--group by 1,2,3,4
--order by 1,2,3,4

--------------------------------------------------------------------------分割线----------------------------------------------------------

--推荐
select 
	left(`date`,7) month
	,count(distinct distinct_id) UV
	,count(case when event='Page_view' then distinct_id end) PV
	,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
	,count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_bind	
	,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
	,count(case when event='Page_view' then distinct_id end) - count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where 1=1
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and event_time >='2024-11-01'
and event in ('Page_view','Page_entry')
and page_title='推荐'
--and btn_name ='开始绑车'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1

--此刻
select 
	left(`date`,7) month
	,count(distinct distinct_id) UV
	,count(case when event='Page_view' then distinct_id end) PV
	,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
	,count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_bind	
	,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
	,count(case when event='Page_view' then distinct_id end) - count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where 1=1
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and event_time >='2024-11-01'
and event in ('Page_view','Page_entry')
and page_title='此刻'
--and btn_name ='开始绑车'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1

--圈子/此地
select 
	left(`date`,7) month
	,count(distinct distinct_id) UV
	,count(case when event='Page_view' then distinct_id end) PV
	,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
	,count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_bind	
	,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
	,count(case when event='Page_view' then distinct_id end) - count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where 1=1
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and event_time >='2024-11-01'
and event in ('Page_view','Page_entry')
and page_title in ('圈子','此地')
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1


--banner1
select 
concat(btn_name::String ,var_lateral_position::String) DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='推荐'
and btn_name ='推荐Banner'
and var_lateral_position in ('1','2','3','4','5')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
--and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1

--快速入口
select 
concat(var_subtitle_name::String ,var_lateral_position::String) DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and var_subtitle_name ='快速入口'
and var_lateral_position in ('1','2','3')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1

--广告位
select 
--btn_name
count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title='推荐'
and btn_name ='广告'
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
--group by 1
--order by 1

--互动
select 
btn_name
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title='推荐'
and btn_name in ('文章',
'点赞',
'UGC',
'动态',
'评论',
'专栏',
'收藏',
'话题')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1

--发布btn
select 
count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title='推荐'
and btn_name in (
'发布加号',
'发动态',
'写文章')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9


--此地 圈子banner1
select 
concat(btn_name::String ,var_lateral_position::String) DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title in ('圈子','此地')
and btn_name ='banner'
and var_lateral_position in ('1','2','3','4')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1
order by 1

--此地 最新活动
select 
--concat(btn_name::String ,var_lateral_position::String) DW
count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title in ('圈子','此地')
and btn_name ='更多'
and var_subtitle_name ='最新活动'
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
--group by 1
--order by 1


-- 埋点测试
select distinct 
car_type
,btn_name
,content_title 
,var_subtitle_name
,column_name
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and page_title ='购车'
--and btn_name<>'内容'
--order by 1,2,3


--EX30
select 
	car_type
	,left(`date`,7) month
	,count(distinct distinct_id) UV
	,count(case when event='Page_view' then distinct_id end) PV
	,count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_bind
	,count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_bind	
	,count(distinct distinct_id) - count(distinct case when var_is_bind in ('1','true') then distinct_id end) UV_fensi
	,count(case when event='Page_view' then distinct_id end) - count(case when event='Page_view' and var_is_bind in ('1','true') then distinct_id end) PV_fensi
from dwd_23.dwd_23_gio_tracking 
where 1=1
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and event_time >='2024-11-01'
and event in ('Page_view','Page_entry')
and page_title ='购车'
--and car_type='EX30'
and car_type in ('EX30',
'XC60',
'XC90',
'S90',
'EM90',
'XC40 RECHARGE',
'V60',
'C40 RECHARGE',
'V90 Cross Country',
'XC40',
'S60'
)
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
group by 1,2
order by 1,2


-- EX30 button
select 
car_type
,btn_name DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name in ('预约试驾',
'立即订购',
'短促Banner',
'金融购车')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type in ('EX30',
'XC60',
'XC90',
'S90',
'EM90',
'XC40 RECHARGE',
'V60',
'C40 RECHARGE',
'V90 Cross Country',
'XC40',
'S60'
)
group by 1,2
order by 1,2 desc

-- 服务承诺
select 
car_type
--,btn_name DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name ='了解详情'
and content_title='服务承诺'
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type in ('EX30',
'XC60',
'XC90',
'S90',
'EM90',
'XC40 RECHARGE',
'V60',
'C40 RECHARGE',
'V90 Cross Country',
'XC40',
'S60'
)
group by 1
order by 1

-- 购车门店
select 
car_type
--,btn_name DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and ((btn_name ='更多'and content_title='购车门店') or (btn_name in ('经销商图','导航icon')))
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type in ('EX30',
'XC60',
'XC90',
'S90',
'EM90',
'XC40 RECHARGE',
'V60',
'C40 RECHARGE',
'V90 Cross Country',
'XC40',
'S60'
)
group by 1
order by 1

-- 常用工具
select 
car_type
--,btn_name DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name in ('金融计算器','置换增购')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type in ('EX30',
'XC60',
'XC90',
'S90',
'EM90',
'XC40 RECHARGE',
'V60',
'C40 RECHARGE',
'V90 Cross Country',
'XC40',
'S60'
)
group by 1
order by 1

-- 车型解读
select 
car_type
--,btn_name DW
,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_UV`,count(case when left(`date`,7)='2023-01' then distinct_id end) `2023-01_PV`,count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_UV_chezhu`,count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_chezhu`,count(distinct case when left(`date`,7)='2023-01' then distinct_id end) - count(distinct case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end)`2023-01_UV_fensi`,count(case when left(`date`,7)='2023-01' then distinct_id end)- count(case when left(`date`,7)='2023-01' and var_is_bind in ('1','true') then distinct_id end) `2023-01_PV_fensi`
,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_UV`,count(case when left(`date`,7)='2023-02' then distinct_id end) `2023-02_PV`,count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_UV_chezhu`,count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_chezhu`,count(distinct case when left(`date`,7)='2023-02' then distinct_id end) - count(distinct case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end)`2023-02_UV_fensi`,count(case when left(`date`,7)='2023-02' then distinct_id end)- count(case when left(`date`,7)='2023-02' and var_is_bind in ('1','true') then distinct_id end) `2023-02_PV_fensi`
,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_UV`,count(case when left(`date`,7)='2023-03' then distinct_id end) `2023-03_PV`,count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_UV_chezhu`,count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_chezhu`,count(distinct case when left(`date`,7)='2023-03' then distinct_id end) - count(distinct case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end)`2023-03_UV_fensi`,count(case when left(`date`,7)='2023-03' then distinct_id end)- count(case when left(`date`,7)='2023-03' and var_is_bind in ('1','true') then distinct_id end) `2023-03_PV_fensi`
,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_UV`,count(case when left(`date`,7)='2023-04' then distinct_id end) `2023-04_PV`,count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_UV_chezhu`,count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_chezhu`,count(distinct case when left(`date`,7)='2023-04' then distinct_id end) - count(distinct case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end)`2023-04_UV_fensi`,count(case when left(`date`,7)='2023-04' then distinct_id end)- count(case when left(`date`,7)='2023-04' and var_is_bind in ('1','true') then distinct_id end) `2023-04_PV_fensi`
,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_UV`,count(case when left(`date`,7)='2023-05' then distinct_id end) `2023-05_PV`,count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_UV_chezhu`,count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_chezhu`,count(distinct case when left(`date`,7)='2023-05' then distinct_id end) - count(distinct case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end)`2023-05_UV_fensi`,count(case when left(`date`,7)='2023-05' then distinct_id end)- count(case when left(`date`,7)='2023-05' and var_is_bind in ('1','true') then distinct_id end) `2023-05_PV_fensi`
,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_UV`,count(case when left(`date`,7)='2023-06' then distinct_id end) `2023-06_PV`,count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_UV_chezhu`,count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_chezhu`,count(distinct case when left(`date`,7)='2023-06' then distinct_id end) - count(distinct case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end)`2023-06_UV_fensi`,count(case when left(`date`,7)='2023-06' then distinct_id end)- count(case when left(`date`,7)='2023-06' and var_is_bind in ('1','true') then distinct_id end) `2023-06_PV_fensi`
,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_UV`,count(case when left(`date`,7)='2023-07' then distinct_id end) `2023-07_PV`,count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_UV_chezhu`,count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_chezhu`,count(distinct case when left(`date`,7)='2023-07' then distinct_id end) - count(distinct case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end)`2023-07_UV_fensi`,count(case when left(`date`,7)='2023-07' then distinct_id end)- count(case when left(`date`,7)='2023-07' and var_is_bind in ('1','true') then distinct_id end) `2023-07_PV_fensi`
,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_UV`,count(case when left(`date`,7)='2023-08' then distinct_id end) `2023-08_PV`,count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_UV_chezhu`,count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_chezhu`,count(distinct case when left(`date`,7)='2023-08' then distinct_id end) - count(distinct case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end)`2023-08_UV_fensi`,count(case when left(`date`,7)='2023-08' then distinct_id end)- count(case when left(`date`,7)='2023-08' and var_is_bind in ('1','true') then distinct_id end) `2023-08_PV_fensi`
,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_UV`,count(case when left(`date`,7)='2023-09' then distinct_id end) `2023-09_PV`,count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_UV_chezhu`,count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_chezhu`,count(distinct case when left(`date`,7)='2023-09' then distinct_id end) - count(distinct case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end)`2023-09_UV_fensi`,count(case when left(`date`,7)='2023-09' then distinct_id end)- count(case when left(`date`,7)='2023-09' and var_is_bind in ('1','true') then distinct_id end) `2023-09_PV_fensi`
,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_UV`,count(case when left(`date`,7)='2023-10' then distinct_id end) `2023-10_PV`,count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_UV_chezhu`,count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_chezhu`,count(distinct case when left(`date`,7)='2023-10' then distinct_id end) - count(distinct case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end)`2023-10_UV_fensi`,count(case when left(`date`,7)='2023-10' then distinct_id end)- count(case when left(`date`,7)='2023-10' and var_is_bind in ('1','true') then distinct_id end) `2023-10_PV_fensi`
,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_UV`,count(case when left(`date`,7)='2023-11' then distinct_id end) `2023-11_PV`,count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_UV_chezhu`,count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_chezhu`,count(distinct case when left(`date`,7)='2023-11' then distinct_id end) - count(distinct case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end)`2023-11_UV_fensi`,count(case when left(`date`,7)='2023-11' then distinct_id end)- count(case when left(`date`,7)='2023-11' and var_is_bind in ('1','true') then distinct_id end) `2023-11_PV_fensi`
,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_UV`,count(case when left(`date`,7)='2023-12' then distinct_id end) `2023-12_PV`,count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_UV_chezhu`,count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_chezhu`,count(distinct case when left(`date`,7)='2023-12' then distinct_id end) - count(distinct case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end)`2023-12_UV_fensi`,count(case when left(`date`,7)='2023-12' then distinct_id end)- count(case when left(`date`,7)='2023-12' and var_is_bind in ('1','true') then distinct_id end) `2023-12_PV_fensi`
,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_UV`,count(case when left(`date`,7)='2024-01' then distinct_id end) `2024-01_PV`,count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_UV_chezhu`,count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_chezhu`,count(distinct case when left(`date`,7)='2024-01' then distinct_id end) - count(distinct case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end)`2024-01_UV_fensi`,count(case when left(`date`,7)='2024-01' then distinct_id end)- count(case when left(`date`,7)='2024-01' and var_is_bind in ('1','true') then distinct_id end) `2024-01_PV_fensi`
,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_UV`,count(case when left(`date`,7)='2024-02' then distinct_id end) `2024-02_PV`,count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_UV_chezhu`,count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_chezhu`,count(distinct case when left(`date`,7)='2024-02' then distinct_id end) - count(distinct case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end)`2024-02_UV_fensi`,count(case when left(`date`,7)='2024-02' then distinct_id end)- count(case when left(`date`,7)='2024-02' and var_is_bind in ('1','true') then distinct_id end) `2024-02_PV_fensi`
,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_UV`,count(case when left(`date`,7)='2024-03' then distinct_id end) `2024-03_PV`,count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_UV_chezhu`,count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_chezhu`,count(distinct case when left(`date`,7)='2024-03' then distinct_id end) - count(distinct case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end)`2024-03_UV_fensi`,count(case when left(`date`,7)='2024-03' then distinct_id end)- count(case when left(`date`,7)='2024-03' and var_is_bind in ('1','true') then distinct_id end) `2024-03_PV_fensi`
,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_UV`,count(case when left(`date`,7)='2024-04' then distinct_id end) `2024-04_PV`,count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_UV_chezhu`,count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_chezhu`,count(distinct case when left(`date`,7)='2024-04' then distinct_id end) - count(distinct case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end)`2024-04_UV_fensi`,count(case when left(`date`,7)='2024-04' then distinct_id end)- count(case when left(`date`,7)='2024-04' and var_is_bind in ('1','true') then distinct_id end) `2024-04_PV_fensi`
,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_UV`,count(case when left(`date`,7)='2024-05' then distinct_id end) `2024-05_PV`,count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_UV_chezhu`,count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_chezhu`,count(distinct case when left(`date`,7)='2024-05' then distinct_id end) - count(distinct case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end)`2024-05_UV_fensi`,count(case when left(`date`,7)='2024-05' then distinct_id end)- count(case when left(`date`,7)='2024-05' and var_is_bind in ('1','true') then distinct_id end) `2024-05_PV_fensi`
,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_UV`,count(case when left(`date`,7)='2024-06' then distinct_id end) `2024-06_PV`,count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_UV_chezhu`,count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_chezhu`,count(distinct case when left(`date`,7)='2024-06' then distinct_id end) - count(distinct case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end)`2024-06_UV_fensi`,count(case when left(`date`,7)='2024-06' then distinct_id end)- count(case when left(`date`,7)='2024-06' and var_is_bind in ('1','true') then distinct_id end) `2024-06_PV_fensi`
from dwd_23.dwd_23_gio_tracking 
where event ='Button_click'
and page_title ='购车'
and btn_name ='内容'
and column_name in ('官方解读','大咖测评','用户口碑')
and event_time >='2024-11-01'
and `date` >= '2024-11-01' 
and `date` <'2024-12-01'
and (((`$lib` in ('iOS','Android','HarmonyOS') and left(`$client_version`,1)='5') or channel ='App') or (`$lib` in('MiniProgram') or channel ='Mini'))
and LENGTH(distinct_id)<9
and car_type in ('EX30',
'XC60',
'XC90',
'S90',
'EM90',
'XC40 RECHARGE',
'V60',
'C40 RECHARGE',
'V90 Cross Country',
'XC40',
'S60'
)
group by 1
order by 1